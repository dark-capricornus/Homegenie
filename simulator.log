INFO:src.simulators.device_simulator:DeviceSimulator initialized - Broker: localhost:1883
ğŸ¤– Starting Device Simulator...
ğŸ“¡ MQTT Broker: localhost:1883
ğŸ›‘ Press Ctrl+C to stop

ğŸš€ Starting DeviceSimulator...
   ğŸ“¡ MQTT Broker: localhost:1883
   ğŸ¯ Listening for commands on: home/+/+/set
   ğŸ“Š Publishing states to: home/+/+/state
   ğŸ¤– Client ID: device_simulator_20251003_122718

ğŸ“Š Sensor Update: home/living_room/temperature/state -> 22.1
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 565
âœ… Subscribed to device commands
ğŸ’¡ Ready to simulate devices! Send commands to test...
------------------------------------------------------------
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 20.5
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 420
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.1
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 549
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 22.2
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 318
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.7
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 408
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 20.3
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 151
ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/lock/front_door/set
   ğŸ“¦ Payload: {"action": "lock", "timestamp": "2025-10-03T12:30:14.633661", "source": "executor_agent", "value": true, "scheduled_at": "2025-10-03T12:30:14.633613", "priority": 1, "estimated_duration": 0.8}
   ğŸ¯ Device: lock.front_door
   âš¡ Action: lock
   ğŸ“Š Value: True
   âœ… State Published:
   ğŸ“ Topic: home/lock/front_door/state
   ğŸ“¦ New State: {
      "locked": true,
      "battery": 75.61767943610434,
      "timestamp": "2025-10-03T12:30:15.442082",
      "device_type": "lock",
      "location": "front_door",
      "online": true,
      "last_access": "2025-10-03T12:30:15.442073"
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/light/bedroom/set
   ğŸ“¦ Payload: {"action": "set_brightness", "timestamp": "2025-10-03T12:30:14.636667", "source": "executor_agent", "value": 10, "scheduled_at": "2025-10-03T12:30:14.633585", "priority": 2, "estimated_duration": 0.5}
   ğŸ¯ Device: light.bedroom
   âš¡ Action: set_brightness
   ğŸ“Š Value: 10
   âœ… State Published:
   ğŸ“ Topic: home/light/bedroom/state
   ğŸ“¦ New State: {
      "state": "on",
      "brightness": 10,
      "color": "white",
      "timestamp": "2025-10-03T12:30:15.952037",
      "device_type": "light",
      "location": "bedroom",
      "online": true,
      "power_consumption": 8.0
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/light/living_room/set
   ğŸ“¦ Payload: {"action": "turn_off", "timestamp": "2025-10-03T12:30:14.638928", "source": "executor_agent", "value": false, "scheduled_at": "2025-10-03T12:30:14.633598", "priority": 2, "estimated_duration": 0.5}
   ğŸ¯ Device: light.living_room
   âš¡ Action: turn_off
   ğŸ“Š Value: False
   âœ… State Published:
   ğŸ“ Topic: home/light/living_room/state
   ğŸ“¦ New State: {
      "state": "off",
      "brightness": 0,
      "color": "white",
      "timestamp": "2025-10-03T12:30:16.455206",
      "device_type": "light",
      "location": "living_room",
      "online": true,
      "power_consumption": 0.0
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/thermostat/main/set
   ğŸ“¦ Payload: {"action": "set_temperature", "timestamp": "2025-10-03T12:30:14.642001", "source": "executor_agent", "value": 20.0, "scheduled_at": "2025-10-03T12:30:14.633607", "priority": 3, "estimated_duration": 1.0}
   ğŸ¯ Device: thermostat.main
   âš¡ Action: set_temperature
   ğŸ“Š Value: 20.0
   âœ… State Published:
   ğŸ“ Topic: home/thermostat/main/state
   ğŸ“¦ New State: {
      "temperature": 23.7,
      "target": 20.0,
      "mode": "auto",
      "timestamp": "2025-10-03T12:30:17.457277",
      "device_type": "thermostat",
      "location": "main",
      "online": true,
      "humidity": 42
}

ğŸ“Š Sensor Update: home/living_room/temperature/state -> 24.2
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 991
ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/light/living_room/set
   ğŸ“¦ Payload: {"action": "turn_on", "timestamp": "2025-10-03T12:30:46.487358", "source": "executor_agent", "value": true, "scheduled_at": "2025-10-03T12:30:46.487298", "priority": 2, "estimated_duration": 0.5}
   ğŸ¯ Device: light.living_room
   âš¡ Action: turn_on
   ğŸ“Š Value: True
   âœ… State Published:
   ğŸ“ Topic: home/light/living_room/state
   ğŸ“¦ New State: {
      "state": "on",
      "brightness": 50,
      "color": "white",
      "timestamp": "2025-10-03T12:30:46.992716",
      "device_type": "light",
      "location": "living_room",
      "online": true,
      "power_consumption": 40.0
}

ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.5
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 833
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.9
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 660
ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/light/living_room/set
   ğŸ“¦ Payload: {"action": "set_brightness", "timestamp": "2025-10-03T12:31:18.503565", "source": "executor_agent", "value": 20, "scheduled_at": "2025-10-03T12:31:18.503481", "priority": 2, "estimated_duration": 0.5}
   ğŸ¯ Device: light.living_room
   âš¡ Action: set_brightness
   ğŸ“Š Value: 20
   âœ… State Published:
   ğŸ“ Topic: home/light/living_room/state
   ğŸ“¦ New State: {
      "state": "on",
      "brightness": 20,
      "color": "white",
      "timestamp": "2025-10-03T12:31:19.010577",
      "device_type": "light",
      "location": "living_room",
      "online": true,
      "power_consumption": 16.0
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/light/kitchen/set
   ğŸ“¦ Payload: {"action": "turn_off", "timestamp": "2025-10-03T12:31:18.506883", "source": "executor_agent", "value": false, "scheduled_at": "2025-10-03T12:31:18.503491", "priority": 2, "estimated_duration": 0.5}
   ğŸ¯ Device: light.kitchen
   âš¡ Action: turn_off
   ğŸ“Š Value: False
   âœ… State Published:
   ğŸ“ Topic: home/light/kitchen/state
   ğŸ“¦ New State: {
      "state": "off",
      "brightness": 0,
      "color": "white",
      "timestamp": "2025-10-03T12:31:19.513014",
      "device_type": "light",
      "location": "kitchen",
      "online": true,
      "power_consumption": 0.0
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/thermostat/main/set
   ğŸ“¦ Payload: {"action": "set_temperature", "timestamp": "2025-10-03T12:31:18.511812", "source": "executor_agent", "value": 21.0, "scheduled_at": "2025-10-03T12:31:18.503497", "priority": 3, "estimated_duration": 1.0}
   ğŸ¯ Device: thermostat.main
   âš¡ Action: set_temperature
   ğŸ“Š Value: 21.0
   âœ… State Published:
   ğŸ“ Topic: home/thermostat/main/state
   ğŸ“¦ New State: {
      "temperature": 23.7,
      "target": 21.0,
      "mode": "auto",
      "timestamp": "2025-10-03T12:31:20.515210",
      "device_type": "thermostat",
      "location": "main",
      "online": true,
      "humidity": 42
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/lock/front_door/set
   ğŸ“¦ Payload: {"action": "lock", "timestamp": "2025-10-03T12:31:28.590458", "source": "executor_agent", "value": true, "scheduled_at": "2025-10-03T12:31:28.590395", "priority": 1, "estimated_duration": 0.8}
   ğŸ¯ Device: lock.front_door
   âš¡ Action: lock
   ğŸ“Š Value: True
   âœ… State Published:
   ğŸ“ Topic: home/lock/front_door/state
   ğŸ“¦ New State: {
      "locked": true,
      "battery": 75.13105098271332,
      "timestamp": "2025-10-03T12:31:29.397248",
      "device_type": "lock",
      "location": "front_door",
      "online": true,
      "last_access": "2025-10-03T12:31:29.397214"
}

ğŸ”§ COMMAND RECEIVED:
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
   ğŸ“ Topic: home/light/living_room/set
   ğŸ“¦ Payload: {"action": "turn_off", "timestamp": "2025-10-03T12:31:28.595860", "source": "executor_agent", "value": false, "scheduled_at": "2025-10-03T12:31:28.590374", "priority": 2, "estimated_duration": 0.5}
   ğŸ¯ Device: light.living_room
   âš¡ Action: turn_off
   ğŸ“Š Value: False
   âœ… State Published:
   ğŸ“ Topic: home/light/living_room/state
   ğŸ“¦ New State: {
      "state": "off",
      "brightness": 0,
      "color": "white",
      "timestamp": "2025-10-03T12:31:29.902053",
      "device_type": "light",
      "location": "living_room",
      "online": true,
      "power_consumption": 0.0
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/thermostat/main/set
   ğŸ“¦ Payload: {"action": "set_temperature", "timestamp": "2025-10-03T12:31:28.598339", "source": "executor_agent", "value": 20.0, "scheduled_at": "2025-10-03T12:31:28.590387", "priority": 3, "estimated_duration": 1.0}
   ğŸ¯ Device: thermostat.main
   âš¡ Action: set_temperature
   ğŸ“Š Value: 20.0
   âœ… State Published:
   ğŸ“ Topic: home/thermostat/main/state
   ğŸ“¦ New State: {
      "temperature": 23.7,
      "target": 20.0,
      "mode": "auto",
      "timestamp": "2025-10-03T12:31:30.907629",
      "device_type": "thermostat",
      "location": "main",
      "online": true,
      "humidity": 42
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/light/bedroom/set
   ğŸ“¦ Payload: {"action": "set_brightness", "timestamp": "2025-10-03T12:31:28.612516", "source": "executor_agent", "value": 75, "scheduled_at": "2025-10-03T12:31:28.612420", "priority": 2, "estimated_duration": 0.5}
   ğŸ¯ Device: light.bedroom
   âš¡ Action: set_brightness
   ğŸ“Š Value: 75
   âœ… State Published:
   ğŸ“ Topic: home/light/bedroom/state
   ğŸ“¦ New State: {
      "state": "on",
      "brightness": 75,
      "color": "white",
      "timestamp": "2025-10-03T12:31:31.409660",
      "device_type": "light",
      "location": "bedroom",
      "online": true,
      "power_consumption": 60.0
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/thermostat/main/set
   ğŸ“¦ Payload: {"action": "set_temperature", "timestamp": "2025-10-03T12:31:28.615458", "source": "executor_agent", "value": 22.0, "scheduled_at": "2025-10-03T12:31:28.612436", "priority": 3, "estimated_duration": 1.0}
   ğŸ¯ Device: thermostat.main
   âš¡ Action: set_temperature
   ğŸ“Š Value: 22.0
   âœ… State Published:
   ğŸ“ Topic: home/thermostat/main/state
   ğŸ“¦ New State: {
      "temperature": 23.7,
      "target": 22.0,
      "mode": "auto",
      "timestamp": "2025-10-03T12:31:32.413218",
      "device_type": "thermostat",
      "location": "main",
      "online": true,
      "humidity": 42
}

ğŸ”§ COMMAND RECEIVED:
   ğŸ“ Topic: home/switch/coffee_maker/set
   ğŸ“¦ Payload: {"action": "turn_on", "timestamp": "2025-10-03T12:31:28.617652", "source": "executor_agent", "value": true, "scheduled_at": "2025-10-03T12:31:28.612443", "priority": 5, "estimated_duration": 0.2}
   ğŸ¯ Device: switch.coffee_maker
   âš¡ Action: turn_on
   ğŸ“Š Value: True
   âœ… State Published:
   ğŸ“ Topic: home/switch/coffee_maker/state
   ğŸ“¦ New State: {
      "state": "on",
      "power_consumption": 5.5023962553497485,
      "timestamp": "2025-10-03T12:31:32.616312",
      "device_type": "switch",
      "location": "coffee_maker",
      "online": true
}

ğŸ“Š Sensor Update: home/living_room/temperature/state -> 24.0
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 521
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 24.9
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 108
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.7
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 985
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.2
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 784
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.6
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 332
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 24.7
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 183
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.5
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 237
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 22.4
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 915
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 24.8
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 248
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 21.3
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 605
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 23.0
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 451
ğŸ“Š Sensor Update: home/living_room/temperature/state -> 20.9
ğŸ“Š Sensor Update: home/bedroom/motion/state -> N/A
ğŸ“Š Sensor Update: home/outdoor/light_sensor/state -> 893
âŒ MQTT error: [code:7] The connection was lost.
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ğŸ”„ Attempting to reconnect in 5 seconds...
âŒ MQTT error: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
ERROR:src.simulators.device_simulator:Error in periodic state updates: [Errno 111] Connection refused
