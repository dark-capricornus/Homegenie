server {events {

    listen       3000;    worker_connections 1024;

    server_name  localhost;}



    root   /var/www/html;http {

    index  index.html index.htm;    include       /etc/nginx/mime.types;

    default_type  application/octet-stream;

    # Handle Flutter web routing

    location / {    sendfile        on;

        try_files $uri $uri/ /index.html;    keepalive_timeout  65;

    }

    server {

    # API proxy to backend        listen       3000;

    location /api/ {        server_name  localhost;

        proxy_pass http://localhost:8000/;

        proxy_set_header Host $host;            root   /var/www/html;

        proxy_set_header X-Real-IP $remote_addr;        index  index.html index.htm;

        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        proxy_set_header X-Forwarded-Proto $scheme;        # Handle Flutter web routing

    }        location / {

            try_files $uri $uri/ /index.html;

    # Handle assets        }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {

        expires 1y;        # API proxy to backend

        add_header Cache-Control "public, immutable";        location /api/ {

    }            proxy_pass http://api-backend:8000/;

            proxy_set_header Host $host;

    # Security headers            proxy_set_header X-Real-IP $remote_addr;

    add_header X-Frame-Options "SAMEORIGIN" always;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

    add_header X-XSS-Protection "1; mode=block" always;            proxy_set_header X-Forwarded-Proto $scheme;

    add_header X-Content-Type-Options "nosniff" always;        }

    add_header Referrer-Policy "no-referrer" always;

    add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;        # Handle assets

}        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }

        # Security headers
        add_header X-Frame-Options "SAMEORIGIN" always;
        add_header X-XSS-Protection "1; mode=block" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header Referrer-Policy "no-referrer" always;
        add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;
    }
}